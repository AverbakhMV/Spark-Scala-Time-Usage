<h1>Time usage – практическая задача Scala / Apache Spark</h1>
<h2>Методика бранчевания и оценки задач</h2>
<p>Основная ветка master содержит исходные шаблоны и набор данных, а также описание задач в описании.</p>
Публикация решения производится следующим образом:
<ol>
    <li>Создается новая ветка от master под именем &lt;фамилия-имя&gt;, например: ivanov-ivan;</li>
    <li>Созданная ветка наполняется кодом и отправляется на слияние в master;</li>
    <li>После инициализации запроса, ответственный разработчик проверяет решение, оставляет свои комментарии или ставит апрув на запрос;</li>
    <li>Решение считается выполненным, если в запросе на слияние стоит апрув ответственного разработчика.</li>
</ol>
<p><strong>ВАЖНО</strong>. Само слияние в master производить запрещено. Мастер ветка содержит только исходные шаблоны, набор данных и описание задач.</p>

<h3>Критерии готовности решения</h3>
Решение считается закрытым исключительно после выполнения следующих критериев:
<ol>
    <li>Исходный код компилируется без ошибок;</li>
    <li>Локальная сборка решения проходит без ошибок;</li>
    <li>Исходный код выполняет поставленную задачу;</li>
    <li>Исходный код покрыт автотестами более чем на 65 процентов;</li>
    <li>Сформирован и верифицирован отчет покрытия автотестами;</li>
    <li>Решение подтверждено ответственным разработчиком.</li>
</ol>

<h2>Local Hadoop</h2>
<p>Перед началом выполнения задач необходимо установить Local Hadoop.</p>
<p>Клиент расположен в архиве: /local_hadoop/Local Hadoop.zip.</p>
Алгоритм установки:
<ol>
    <li>Скопировать папку hadoop из архива, как C:\hadoop;</li>
    <li>Создать папку C:\tmp\hive;</li>
    <li>Найти в C:\hadoop\bin winutils.exe;</li>
    <li>Выполнить в консоли winutils.exe chmod -R 777 C:\tmp\hive;</li>
    <li>Создать системную переменную "Имя:HADOOP_HOME, Значение:C:\hadoop";</li>
    <li>В переменную среды пользователя "Path" добавить путь C:\hadoop\bin.</li>
</ol>

<p><strong>ВАЖНО</strong>. Временная директория нужна для эмуляции работы Apache Hive с помощью Derby DB.
<br/>Соответственно, без прав на запись в данную папку SparkSQL не работает локально.</p>

<h2>Задача</h2>
<p>Общая цель этого задания — реализовать алгоритм подсчета статистики распределения времени между различными группами общества.</p>

<p>Вам предоставляется CSV файл с исходными данными для вычислений. Файл расположен в директории ресурсов проекта.
В файле используется формат значений, разделенных запятыми: первая строка представляет собой заголовок, определяющий 
имена полей каждого столбца, а каждая следующая строка содержит информационную запись, которая сама состоит из нескольких столбцов. 
Данные содержат информацию о том, как люди проводят своё время (спят, едят, работают и т.д.).</p>

Ваша задача определить следующие типы деятельности:
<ul>
    <li>Базовые потребности (сон, прием пищи): primary_needs;</li>
    <li>Работа: work;</li>
    <li>Досуг: other.</li>
</ul>

А также вычислить статистику о том, как люди распределяют свое время между этими тремя видами деятельности, 
и определить, есть ли различия в рамках следующих делений общества:
<ul>
    <li>Пол №(n-1)[м] и пол №(n-2)[ж];</li>
    <li>Занятые и безработные;</li>
    <li>Люди молодого поколения (до 22 лет), среднего поколения (от 23 до 55 лет) и пожилого поколения (от 56 лет).</li>
</ul>

На основе полученных результатов необходимо дать ответы на следующие вопросы:
<ol>
    <li>Сколько времени мы тратим на удовлетворение основных потребностей по сравнению с другими видами деятельности?</li>
    <li>Пол №(n-1)[м] и пол №(n-2)[ж] тратят на работу одинаковое количество времени, если нет, то каково соотношение?</li>
    <li>Меняется ли время, затрачиваемое на удовлетворение основных потребностей, с возрастом, если да, то как именно?</li>
    <li>Сколько времени занятые люди тратят на отдых по сравнению с безработными?</li>
</ol>

<p><strong>ВАЖНО</strong>. В задании нет конкретного описания полей данных (их большое количество).
<br/>Применять зашитую, заранее известную структуру запрещено. Обработка исходного набора данных должна строится на динамической структуре.</p>

Для облегчения маппинга данных предоставляется следующее распределение полей:
<ul>
    <li>Идентификатор респондента - tucaseid;</li>
    <li>Возраст респондента - teage;</li>
    <li>Пол респондента - tesex;</li>
    <li>Базовые потребности – поля начинающийся с t01, t03, t11, t1801, t1803;</li>
    <li>Работа - поля начинающийся с t05 и t1805;</li>
    <li>Досуг - поля начинающийся с t02, t04, t06, t07, t08, t09, t10, t12, t13, t14, t15, t16, t18 (t18 - кроме тех которые входят в предыдущие группы).</li>
</ul>

Алгоритм маппинга в результате должен дать DataFrame по респондентам следующей структуры:<br>
Идентификатор | Пол | Возрастное поколение | Время базовых потребностей в сутки | Время работы в сутки | Время досуга в сутки

Далее, на полученном множестве необходимо провести соответствующие вычисления для получения ответов на заданные выше вопросы.

В целях ~~предотвращения сексистских нападок~~ соблюдения норм современного общества в отчете не указываем название пола, то есть не делим группы на мужчин и женщин, а делим на "пол №(n -1)" и "пол №(n -2)".  